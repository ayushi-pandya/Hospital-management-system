{% extends 'Hospital/base.html' %}
{% load static %}
{% block title %}Admit List{% endblock %}
{% block content %}
    <div class="container">
        <form class="form-inline my-2 my-lg-0" method="post" role="search" action="{% url 'view-admit-patient' %}">
            {% csrf_token %}
            <input type="search" class="form-control" id="view_admit_form" placeholder="search here.." name="search">
            <button class="btn btn-outline-primary my-2 my-sm-0" id="medicine_form" type="submit">Search</button>
            <div class="optionsDiv ml-5">
                Filter by Room-Type:
                <select name="name" id="selectField">
                    <option value="All" selected>All</option>
                    <option value="General" >General</option>
                    <option value="Semi-Private" >Semi-Private</option>
                    <option value="Private" >Private</option>
                </select>
                <input type="submit" value="Filter">
            </div>
        </form>
        <br>
        <h2> Admit Patient List </h2>
        <div class="row">
          <div class="col-sm">
          <table class="table">
          <tr>
            <th>id</th>
            <th>Patient Name</th>
            <th>Admit Date</th>
            <th>Room No</th>
          </tr>

            {% for admt in all_data %}
              <tr>
                <td>{{ admt.id }}</td>
                <td>{{ admt.patient.patient   }}</td>
                <td>{{ admt.in_date }}</td>
                <td>{{ admt.room_id }}</td>
                {% if role.role_id == 1 %}
                    <td> <a href="{% url 'discharge_by_doctor' admt.id %}"><button type="button" class="btn btn-outline-secondary">Discharge Request</button></td>
                {% endif %}
              </tr>
            {% empty %}
                {% for admt in data %}
                  <tr>
                    <td>{{ admt.id }}</td>
                    <td>{{ admt.patient.patient   }}</td>
                    <td>{{ admt.in_date }}</td>
                    <td>{{ admt.room_id }}</td>
                    {% if role.role_id == 1 %}
                        <td> <a href="{% url 'discharge_by_doctor' admt.id %}"><button type="submit" class="btn btn-outline-secondary">Discharge</button></td>
                    {% endif %}
                  </tr>
                {% endfor %}
            {% endfor %}
          </table>
          </div>
        </div>
    </div>
{% endblock %}



{% block scripts %}
  <script>
    console.log('start')
    var availableTags = [ ];

    $.ajax({
        method:"GET",
        url:"{% url 'search_admit' %}",
        success: function (response){
            console.log(response)
            startAutocomplete(response);
        }
    })
    function startAutocomplete(availableTags) {
        $("#view_admit_form").autocomplete({
            source: availableTags
        });
    }
  </script>
{% endblock scripts %}